<!-- Carousel Navigation Buttons -->
<!-- Desktop/Tablet Navigation (overlaid on cards) -->
<button
  (click)="prevSlide()"
  [disabled]="currentIndex === 0"
  class="hidden sm:block absolute left-1 sm:left-2 md:left-4 top-1/2 transform -translate-y-1/2 z-10 p-2 sm:p-3 bg-gray-900/40 backdrop-blur-sm border border-gray-700/50 hover:border-blue-400/50 rounded-full text-white transition-all duration-300 hover:scale-110 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:scale-100"
>
  <svg
    class="w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-blue-400"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M15 19l-7-7 7-7"
    />
  </svg>
</button>

<button
  (click)="nextSlide()"
  [disabled]="currentIndex >= maxIndex"
  class="hidden sm:block absolute right-1 sm:right-2 md:right-4 top-1/2 transform -translate-y-1/2 z-10 p-2 sm:p-3 bg-gray-900/40 backdrop-blur-sm border border-gray-700/50 hover:border-blue-400/50 rounded-full text-white transition-all duration-300 hover:scale-110 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:scale-100"
>
  <svg
    class="w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-blue-400"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M9 5l7 7-7 7"
    />
  </svg>
</button>

<section
  id="projects"
  class="w-full text-white flex flex-col items-center justify-center px-2 xs:px-4 sm:px-6 lg:px-8 py-8 xs:py-10 sm:py-12 md:py-16 lg:py-20 relative"
  [style.min-height]="'100vh'"
>
  <div
    class="max-w-xs xs:max-w-sm sm:max-w-2xl md:max-w-4xl lg:max-w-6xl xl:max-w-7xl w-full"
  >
    <!-- Section Title -->
    <div class="text-center mb-8 xs:mb-10 sm:mb-12 md:mb-14 lg:mb-16">
      <h2
        class="text-2xl xs:text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold mb-2 xs:mb-3 sm:mb-4 text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 animate-pulse leading-tight"
      >
        Projects
      </h2>
      <p
        class="text-gray-300 hover:text-gray-200 transition-colors duration-300 text-sm xs:text-base sm:text-lg md:text-xl max-w-xs xs:max-w-sm sm:max-w-2xl mx-auto px-2 sm:px-0 leading-relaxed"
      >
        Explore my featured work showcasing modern web development and creative
        solutions
      </p>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex justify-center items-center py-20">
      <div class="text-center">
        <div
          class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400 mb-4"
        ></div>
        <p class="text-gray-300">Loading projects...</p>
      </div>
    </div>

    <!-- Projects Carousel Container -->
    <div
      *ngIf="!isLoading"
      class="relative overflow-hidden mb-8 xs:mb-10 sm:mb-12 md:mb-14 lg:mb-16"
    >
      <!-- No Projects Message -->
      <div *ngIf="featuredProjects.length === 0" class="text-center py-20">
        <div class="text-gray-400 mb-4">
          <svg
            class="w-16 h-16 mx-auto mb-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a1 1 0 011-1h6a1 1 0 011 1v2M7 7h10"
            ></path>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-300 mb-2">
          No Projects Yet
        </h3>
        <p class="text-gray-400">
          Projects will appear here once uploaded through the admin panel.
        </p>
      </div>

      <!-- Carousel Track -->
      <div
        *ngIf="featuredProjects.length > 0"
        class="flex transition-transform duration-500 ease-in-out"
        [style.transform]="'translateX(-' + currentIndex * slideWidth + '%)'"
      >
        <!-- Project Card Loop -->
        <div
          *ngFor="
            let project of featuredProjects;
            let i = index;
            trackBy: trackByProjectId
          "
          class="group relative flex-shrink-0"
          [style.width]="slideWidth + '%'"
        >
          <div class="mx-1 xs:mx-2 sm:mx-3 lg:mx-4">
            <div
              class="bg-gray-900/40 backdrop-blur-sm border border-gray-700/50 hover:border-{{
                project.borderColors[0]
              }}/50 rounded-lg xs:rounded-xl sm:rounded-2xl overflow-hidden shadow-xl hover:shadow-2xl hover:shadow-{{
                project.borderColors[0]
              }}/10 transition-all duration-500 group-hover:scale-[1.01] xs:group-hover:scale-[1.02] h-full flex flex-col min-h-[400px] xs:min-h-[450px] sm:min-h-[500px] md:min-h-[520px]"
            >
              <!-- Dynamic Glow Effect -->
              <div
                class="absolute inset-0 bg-gradient-to-r {{
                  project.gradients.card
                }} rounded-lg xs:rounded-xl sm:rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"
              ></div>

              <!-- Project Image -->
              <div class="relative overflow-hidden">
                <div
                  class="w-full h-32 xs:h-36 sm:h-48 md:h-56 lg:h-64 bg-gradient-to-br {{
                    project.gradients.image
                  }} flex items-center justify-center relative"
                >
                  <!-- Project Image or Emoji -->
                  <div
                    *ngIf="!project.image; else projectImage"
                    class="text-3xl xs:text-4xl sm:text-5xl md:text-6xl opacity-50"
                  >
                    {{ project.emoji }}
                  </div>
                  <ng-template #projectImage>
                    <img
                      [src]="project.image"
                      [alt]="project.alt"
                      class="w-full h-full object-cover"
                      loading="lazy"
                      (error)="project.image = ''"
                    />
                  </ng-template>

                  <!-- Desktop Hover Overlay with Dynamic Buttons (hidden on mobile) -->
                  <div
                    class="hidden sm:flex absolute inset-0 bg-gradient-to-t from-gray-900/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 items-end justify-center pb-2 xs:pb-3 sm:pb-4"
                  >
                    <div
                      class="flex flex-wrap justify-center gap-1 xs:gap-2 sm:gap-3 px-2"
                    >
                      <button
                        *ngFor="let button of project.buttons"
                        (click)="onProjectButtonClick(project, button.text)"
                        class="px-2 xs:px-3 sm:px-4 py-1 xs:py-1.5 sm:py-2 {{
                          button.bgColor
                        }} backdrop-blur-sm border {{
                          button.borderColor
                        }} rounded-md sm:rounded-lg {{
                          button.textColor
                        }} text-xs xs:text-sm font-medium {{
                          button.hoverBgColor
                        }} transition-all duration-300 whitespace-nowrap"
                      >
                        {{ button.text }}
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Project Content -->
              <div
                class="relative z-10 p-3 xs:p-4 sm:p-6 md:p-7 lg:p-8 flex-1 flex flex-col"
              >
                <!-- Dynamic Project Title -->
                <h3
                  class="text-base xs:text-lg sm:text-xl md:text-2xl font-bold mb-2 xs:mb-2.5 sm:mb-3 text-transparent bg-clip-text bg-gradient-to-r {{
                    project.gradients.title
                  }} {{
                    project.gradients.titleHover
                  }} transition-all duration-300 leading-tight"
                >
                  {{ project.title }}
                </h3>

                <!-- Dynamic Project Description -->
                <p
                  class="text-gray-300 hover:text-gray-200 transition-colors duration-300 leading-relaxed mb-3 xs:mb-4 sm:mb-6 flex-1 text-xs xs:text-sm sm:text-base line-clamp-3 xs:line-clamp-4 sm:line-clamp-none"
                  [innerHTML]="project.description"
                ></p>

                <!-- Dynamic Tech Stack -->
                <div
                  class="flex flex-wrap gap-1 xs:gap-1.5 sm:gap-2 mb-3 xs:mb-4 sm:mb-6"
                >
                  <span
                    *ngFor="let tech of project.techStack; let i = index"
                    [class.hidden]="
                      i >= 4 && (i >= 6 || getScreenSize() === 'mobile')
                    "
                    class="px-2 xs:px-2.5 sm:px-3 py-0.5 xs:py-1 bg-gradient-to-r {{
                      tech.gradient
                    }} border {{ tech.borderColor }} rounded-full {{
                      tech.textColor
                    }} text-[10px] xs:text-xs font-medium {{
                      tech.hoverGradient
                    }} hover:scale-105 transition-all duration-300 backdrop-blur-sm whitespace-nowrap"
                  >
                    {{ tech.name }}
                  </span>
                  <!-- Show more indicator for mobile -->
                  <span
                    *ngIf="
                      project.techStack.length > 4 &&
                      getScreenSize() === 'mobile'
                    "
                    class="px-2 py-0.5 bg-gray-700/50 border border-gray-600 rounded-full text-gray-400 text-[10px] font-medium"
                  >
                    +{{ project.techStack.length - 4 }}
                  </span>
                </div>

                <!-- Mobile Action Buttons (only visible on mobile) -->
                <div class="sm:hidden flex flex-wrap gap-2 mb-4 relative z-30">
                  <button
                    *ngFor="let button of project.buttons"
                    (click)="onProjectButtonClick(project, button.text)"
                    (touchstart)="$event.stopPropagation()"
                    (touchend)="$event.stopPropagation()"
                    class="flex-1 min-w-0 px-3 py-2 {{
                      button.bgColor
                    }} backdrop-blur-sm border {{
                      button.borderColor
                    }} rounded-lg {{ button.textColor }} text-xs font-medium {{
                      button.hoverBgColor
                    }} transition-all duration-300 text-center"
                  >
                    {{ button.text }}
                  </button>
                </div>

                <!-- Dynamic Project Stats -->
                <div
                  class="flex items-center justify-between text-xs xs:text-sm"
                >
                  <div
                    class="flex items-center space-x-1 xs:space-x-2 text-gray-400"
                  >
                    <svg
                      class="w-3 h-3 xs:w-4 xs:h-4"
                      fill="currentColor"
                      viewBox="0 0 20 20"
                    >
                      <path
                        fill-rule="evenodd"
                        [attr.d]="project.stats.icon"
                        clip-rule="evenodd"
                      />
                    </svg>
                    <span class="truncate">{{ project.stats.label }}</span>
                  </div>
                  <span [class]="project.stats.color + ' font-medium'">{{
                    project.year
                  }}</span>
                </div>
              </div>

              <!-- Dynamic Corner Decorations -->
              <div
                class="absolute -top-0.5 xs:-top-1 -left-0.5 xs:-left-1 w-2 h-2 xs:w-3 xs:h-3 border-l-2 border-t-2 {{
                  project.borderColors[0]
                }} opacity-0 group-hover:opacity-100 transition-opacity duration-500"
              ></div>
              <div
                class="absolute -top-0.5 xs:-top-1 -right-0.5 xs:-right-1 w-2 h-2 xs:w-3 xs:h-3 border-r-2 border-t-2 {{
                  project.borderColors[1]
                }} opacity-0 group-hover:opacity-100 transition-opacity duration-500"
              ></div>
              <div
                class="absolute -bottom-0.5 xs:-bottom-1 -left-0.5 xs:-left-1 w-2 h-2 xs:w-3 xs:h-3 border-l-2 border-b-2 {{
                  project.borderColors[2]
                }} opacity-0 group-hover:opacity-100 transition-opacity duration-500"
              ></div>
              <div
                class="absolute -bottom-0.5 xs:-bottom-1 -right-0.5 xs:-right-1 w-2 h-2 xs:w-3 xs:h-3 border-r-2 border-b-2 {{
                  project.borderColors[3]
                }} opacity-0 group-hover:opacity-100 transition-opacity duration-500"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation Buttons (for all devices) -->
    <div
      *ngIf="!isLoading && featuredProjects.length > 0"
      class="flex justify-center items-center space-x-4 mb-6 xs:mb-8 relative z-30"
    >
      <button
        (click)="prevSlide()"
        [disabled]="currentIndex === 0"
        class="p-2 xs:p-3 bg-gray-900/40 backdrop-blur-sm border border-gray-700/50 hover:border-blue-400/50 rounded-full text-white transition-all duration-300 hover:scale-110 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:scale-100"
      >
        <svg
          class="w-4 h-4 xs:w-5 xs:h-5 text-blue-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"
          />
        </svg>
      </button>

      <div class="flex items-center space-x-2 text-gray-400 text-sm">
        <span>{{ currentIndex + 1 }} / {{ featuredProjects.length }}</span>
      </div>

      <button
        (click)="nextSlide()"
        [disabled]="currentIndex >= maxIndex"
        class="p-2 xs:p-3 bg-gray-900/40 backdrop-blur-sm border border-gray-700/50 hover:border-blue-400/50 rounded-full text-white transition-all duration-300 hover:scale-110 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:scale-100"
      >
        <svg
          class="w-4 h-4 xs:w-5 xs:h-5 text-blue-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
      </button>
    </div>

    <!-- Carousel Indicators -->
    <div
      *ngIf="!isLoading && featuredProjects.length > 0"
      class="flex justify-center space-x-2 xs:space-x-3 mb-6 xs:mb-8"
    >
      <button
        *ngFor="let _ of getIndicatorArray(); let i = index"
        (click)="goToSlide(i)"
        class="w-2 h-2 xs:w-2.5 xs:h-2.5 sm:w-3 sm:h-3 rounded-full transition-all duration-300"
        [class]="
          currentIndex === i
            ? 'bg-blue-400 shadow-lg shadow-blue-400/50 scale-110'
            : 'bg-gray-600 hover:bg-gray-500 hover:scale-105'
        "
        [attr.aria-label]="'Go to slide ' + (i + 1)"
      ></button>
    </div>

    <!-- Mobile Swipe Instructions -->
    <div
      *ngIf="!isLoading && featuredProjects.length > 0"
      class="sm:hidden text-center mb-4"
    >
      <p
        class="text-gray-400 text-xs flex items-center justify-center space-x-2"
      >
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M7 16l-4-4m0 0l4-4m-4 4h18"
          />
        </svg>
        <span>Swipe or use arrows to navigate</span>
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M17 8l4 4m0 0l-4 4m4-4H3"
          />
        </svg>
      </p>
    </div>

    <!-- Floating Decorative Elements -->
    <div
      *ngIf="!isLoading"
      class="flex justify-center space-x-2 xs:space-x-3 sm:space-x-4 opacity-30"
    >
      <div
        class="w-1.5 h-1.5 xs:w-2 xs:h-2 bg-cyan-400/40 rounded-full animate-pulse"
      ></div>
      <div
        class="w-1 h-1 bg-blue-400/40 rounded-full animate-pulse"
        style="animation-delay: 0.5s"
      ></div>
      <div
        class="w-1.5 h-1.5 xs:w-2 xs:h-2 bg-purple-400/40 rounded-full animate-pulse"
        style="animation-delay: 1s"
      ></div>
    </div>

    <!-- Touch/Swipe Area for Mobile - Only on carousel track -->
    <div
      *ngIf="!isLoading && featuredProjects.length > 0"
      class="sm:hidden absolute pointer-events-none z-0"
      (touchstart)="onTouchStart($event)"
      (touchmove)="onTouchMove($event)"
      (touchend)="onTouchEnd($event)"
      style="pointer-events: auto; top: 120px; left: 0; right: 0; bottom: 350px"
    ></div>
  </div>
</section>
